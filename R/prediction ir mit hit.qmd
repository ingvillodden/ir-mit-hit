---
title: "prediction ir mit hit"
format: html
editor: visual
editor_options: 
  chunk_output_type: console
---

#### Predicting individual responses to a MIT block and a HIT block: Mechanisms/characteristics underlying individual response variability


## Session characteristics
```{r}

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(rel.vo2 ~ lat.avg + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(rel.vo2 ~ peak.torque.60 + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()



```




#### Fractional utilization and % of VO2max sessions
```{r}

# Relationship between % of VO2max at PO4mmol at baseline and % of VO2max during sessions
# Blocks together
mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(rel.vo2 ~ pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

figure <- data %>% 
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  ggplot(aes(x=pre, y=rel.vo2)) +
  geom_point(aes(shape=period, color=period), size = point.size) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = line.width) + # se = confidence intervals
  scale_color_manual(values = col_scale) +
  theme_pubr() +
  scale_y_continuous(limits = c(65, 100), 
                     breaks = seq(from = 65, to = 100, by = 5), 
                     expand = c(0.05, 0.05)) +
  scale_x_continuous(limits = c(70, 88), 
                     breaks = seq(from = 70, to = 88, by = 2), 
                     expand = c(0.05, 0.05)) +
  labs(x = expression("% of VO"["2max"]*" at PO"["4mmol"]*" at baseline (%) "), y = expression("% of VO"["2max"]*" during sessions (%) ")) +
  theme(text=element_text(family="serif", face="plain", size=lable.size),
        legend.position = "none",
        axis.line.x = element_line(size = axis.width),
        axis.line.y = element_line(size = axis.width),
        axis.ticks = element_line(size = axis.ticks.width),
        axis.ticks.length = unit(0.05, "cm"))
figure



```

#### % of VO2max during sessions

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * rel.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * rel.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * rel.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * rel.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * rel.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * rel.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * rel.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()




figure5A <- data %>% 
  filter(period != "con", variable == "w.rel.15tt") %>%
  ggplot(aes(x=rel.vo2, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = 1) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = 0.8) + # se = confidence intervals
  theme_pubr() +
  scale_y_continuous(limits = c(-0.25, 1), 
                     breaks = seq(from = -0.25, to = 1, by = 0.25), 
                     expand = c(0.02, 0.02)) +
  labs(x = expression("% of VO"["2max"]*"  during interval sessions (%) "), y = expression("∆ PO"["15-min"]*"  ( W ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=4),
        legend.position = "none")
figure5A

figure6 <- data %>% 
  filter(period != "con", variable == "vo2.rel.max") %>%
  ggplot(aes(x=rel.vo2, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = 1) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = 1) + # se = confidence intervals
  theme_pubr() +
  labs(x = expression("% of VO"["2max"]*"  during interval sessions (%) "), y = expression("∆ VO"["2max"]*"  ( mL ∙ min"^-1*" ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=11))
figure6

```

#### Time \> 90% of VO2max during sessions

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * sec.90.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * sec.90.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * sec.90.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * sec.90.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * sec.90.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * sec.90.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * sec.90.vo2 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()


figure <- data %>% 
  filter(period != "con", variable == "vo2.rel.max") %>%
  ggplot(aes(x=sec.90.vo2, y=change, color=period)) +
  geom_point() +
  geom_smooth(method="lm", se=TRUE, level = 0.95) + 
  theme_pubr() +
  labs(x = expression("Time > 90% of VO"["2max"]*"  during interval sessions (%) "), y = expression("∆ VO"["2max"]*"  ( mL ∙ min"^-1*" ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=11))
figure

```

#### % of HRmax during sessions

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * rel.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * rel.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * rel.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * rel.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * rel.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * rel.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * rel.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

#### Time \> 90% of HRmax during sessions

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * sec.90.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * sec.90.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * sec.90.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * sec.90.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * sec.90.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * sec.90.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * sec.90.hr + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()


figure <- data %>% 
  filter(period != "con", variable == "ge.3.fresh") %>%
  ggplot(aes(x=sec.90.hr, y=change, color=period)) +
  geom_point() +
  geom_smooth(method="lm", se=TRUE, level = 0.95) + 
  theme_pubr() +
  labs(x = expression("Time > 90% of VO"["2max"]*"  during interval sessions (%) "), y = expression("∆ VO"["2max"]*"  ( mL ∙ min"^-1*" ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=11))
figure

```

#### Aerobic energy turnover (kJ)

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * pi.total.kj + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * pi.total.kj + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * pi.total.kj + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * pi.total.kj + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * pi.total.kj + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * pi.total.kj + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * pi.total.kj + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()


figure <- data %>% 
  filter(period != "con", variable == "vo2.rel.max") %>%
  ggplot(aes(x=pi.total.kj, y=change, color=period)) +
  geom_point() +
  geom_smooth(method="lm", se=TRUE, level = 0.95) + 
  theme_pubr() +
  labs(x = "Total power input (kJ)", y = expression("∆ VO"["2max"]*"  ( mL ∙ min"^-1*" ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=11))
figure

```

## Whole body characteristics

#### PO 40min cycling trial

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * w.rel.40tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * w.rel.40tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * w.rel.40tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * w.rel.40tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * w.rel.40tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * w.rel.40tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * w.rel.40tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

#### PO 15min cycling trial

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * w.rel.15tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * w.rel.15tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * w.rel.15tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * w.rel.15tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * w.rel.15tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * w.rel.15tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * w.rel.15tt + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

figure <- data %>% 
  filter(period != "con", variable == "ge.3.fresh") %>%
  ggplot(aes(x=w.rel.15tt, y=change, color=period)) +
  geom_point() +
  geom_smooth(method="lm", se=TRUE, level = 0.95) + 
  theme_pubr() +
  labs(x = expression("PO"["15min"]*"  ( W ∙ kg"^-1*") at baseline"), y = "∆ GE (%-points)") +
  theme(text=element_text(family="serif", face="plain", size=11))
figure

```

#### POVO2max at baseline

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * w.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * w.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * w.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * w.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * w.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * w.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * w.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()



```

#### PO 4mmol/L \[blood lactate\]

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * w.rel.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * w.rel.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * w.rel.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * w.rel.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * w.rel.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * w.rel.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * w.rel.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

#### VO2max at baseline

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * vo2.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * vo2.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * vo2.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * vo2.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * vo2.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * vo2.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * vo2.rel.max + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

#### % of VO2max at 4mmol baseline

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * p.vo2.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * p.vo2.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * p.vo2.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * p.vo2.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * p.vo2.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * p.vo2.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * p.vo2.4mmol + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

figure5B <- data %>% 
  filter(period != "con", variable == "w.rel.15tt") %>%
  ggplot(aes(x=p.vo2.4mmol, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = 1) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = 0.8) + # se = confidence intervals
  theme_pubr() +
  scale_y_continuous(limits = c(-0.25, 1), 
                     breaks = seq(from = -0.25, to = 1, by = 0.25), 
                     expand = c(0.02, 0.02)) +
  labs(x = expression("% of VO"["2max"]*"4mmol  at baseline (%) "), y = expression("∆ PO"["15min"]*"  ( W ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=11),
        legend.position = "none")
figure5B

```

#### GE at baseline

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * ge.3.fresh + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * ge.3.fresh + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * ge.3.fresh + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * ge.3.fresh + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * ge.3.fresh + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * ge.3.fresh + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * ge.3.fresh + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

#### Isometric peak torque at 60 degrees/sec at baseline

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * peak.torque.60 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * peak.torque.60 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * peak.torque.60 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * peak.torque.60 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * peak.torque.60 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * peak.torque.60 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * peak.torque.60 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()


figure5C <- data %>% 
  filter(period != "con", variable == "w.rel.15tt") %>%
  ggplot(aes(x=peak.torque.60, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = 1) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = 0.8) + # se = confidence intervals
  theme_pubr() +
  scale_y_continuous(limits = c(-0.25, 1), 
                     breaks = seq(from = -0.25, to = 1, by = 0.25), 
                     expand = c(0.02, 0.02)) +
  labs(x = "Isometric peak torque 60 d/s", y = expression("∆ PO"["15min"]*"  ( W ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=11),
        legend.position = "none")
figure5C

```

#### Isometric peak torque at 240 degrees/sec at baseline

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * peak.torque.240 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * peak.torque.240 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * peak.torque.240 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * peak.torque.240 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * peak.torque.240 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * peak.torque.240 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * peak.torque.240 + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()


```

## Muscle characteristics

#### Muscle thickness (m. vastus lateralis, average of upper and lower part)

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * lat.avg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * lat.avg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * lat.avg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * lat.avg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * lat.avg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * lat.avg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * lat.avg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()


figure5D <- data %>% 
  filter(period != "con", variable == "w.rel.15tt") %>%
  ggplot(aes(x=lat.avg, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = 1) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = 0.8) + # se = confidence intervals
  theme_pubr() +
  scale_y_continuous(limits = c(-0.25, 1), 
                     breaks = seq(from = -0.25, to = 1, by = 0.25), 
                     expand = c(0.02, 0.02)) +
  labs(x = "Muscle thickness m. vastus lateralis", y = expression("∆ PO"["15min"]*"  ( W ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=11),
        legend.position = "none")
figure5D

```

#### Lean mass legs (kg) at baseline

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * lean.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * lean.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * lean.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * lean.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * lean.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * lean.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * lean.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

#### Fat free mass legs (kg) at baseline

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * fat.free.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * fat.free.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * fat.free.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * fat.free.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * fat.free.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * fat.free.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * fat.free.mass.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

## Blood variables

#### Hemoglobin mass

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * hbmass.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * hbmass.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * hbmass.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * hbmass.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * hbmass.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * hbmass.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * hbmass.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()


figure <- data %>% 
  filter(period != "con", variable == "w.rel.4mmol") %>%
  ggplot(aes(x=hbmass.kg, y=change, color=period)) +
  geom_point() +
  geom_smooth(method="lm", se=TRUE, level = 0.95) + 
  theme_pubr() +
  labs(x = expression("Hb"["mass"]*"  ( g ∙ kg"^-1*") "), y = expression("∆ PO"["4mmol"]*"  ( W ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=11))
figure

```

#### Blood volume

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * bv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * bv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * bv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * bv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * bv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * bv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * bv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

#### Plasma volume

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * pv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * pv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * pv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * pv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * pv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * pv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * pv.kg + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

## Perceived feeling

#### Perceived well-beein in the legs at all performed sessions during the blocks+taper

```{r}

mod <- data %>%
  filter(period != "con", variable == "index") %>%
  lmer(change ~ period * feeling.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.15tt") %>%
  lmer(change ~ period * feeling.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.max") %>%
  lmer(change ~ period * feeling.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "w.rel.4mmol") %>%
  lmer(change ~ period * feeling.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "vo2.rel.max") %>%
  lmer(change ~ period * feeling.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "p.vo2.4mmol") %>%
  lmer(change ~ period * feeling.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

mod <- data %>%
  filter(period != "con", variable == "ge.3.fresh") %>%
  lmer(change ~ period * feeling.legs + pre + (1 | id), data = .) %>%
  summ(confint = TRUE, digits = 3) %>% 
  print()

```

# Figure 5 with panels A, B, C, D

```{r}

# Figure 5 with panels A, B, C, D

# Setting axis width, axis ticks width and length, label size, line width, point size and colours
axis.width <- 0.4
axis.ticks.width <- 0.4
lable.size <- 8
line.width <- 0.5
point.size <- 0.6
col_scale <- c("#8B0000", "#104E8B") # Blue and red
shape_scale <- c(16, 17) # Dot and triangle
line.type_scale <- c("solid", "solid")

#col_scale <- c("#228B22", "#8B0000", "#104E8B") # green, red, blue




# Influence of A) % of maximal oxygen consumption (V̇O2max) during sessions on changes in maximal average power output during the 15-min cycling trial (PO15-min) in the moderate-intensity interval training (MIT) block compared to the high-intensity interval training (HIT) block.
figure5A <- data %>% 
  filter(period != "con", variable == "w.rel.15tt") %>%
  ggplot(aes(x=rel.vo2, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = point.size) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = line.width) + # se = confidence intervals
  scale_color_manual(values = col_scale) +
  theme_pubr() +
  scale_y_continuous(limits = c(-0.40, 1), 
                     breaks = seq(from = -0.25, to = 1, by = 0.25), 
                     expand = c(0, 0.05)) +
  scale_x_continuous(limits = c(68, 90), 
                     breaks = seq(from = 68, to = 90, by = 2), 
                     expand = c(0.05, 0.05)) +
  labs(x = expression("% of VO"["2max"]*"  during interval sessions (%) "), y = expression("∆ PO"["15-min"]*"  (W ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=lable.size),
        legend.position = "none",
        axis.line.x = element_line(size = axis.width),
        axis.line.y = element_line(size = axis.width),
        axis.ticks = element_line(size = axis.ticks.width),
        axis.ticks.length = unit(0.05, "cm"))
figure5A


# Influence of B) fractional utilization of V̇O2max at the power output corresponding to 4 mmol·L-1 [blood lactate] (% of V̇O2max at PO4mmol) at baselineon changes in maximal average power output during the 15-min cycling trial (PO15-min) in the moderate-intensity interval training (MIT) block compared to the high-intensity interval training (HIT) block.
figure5B <- data %>% 
  filter(period != "con", variable == "w.rel.15tt") %>%
  ggplot(aes(x=p.vo2.4mmol, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = point.size) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = line.width) + # se = confidence intervals
  scale_color_manual(values = col_scale) +
  theme_pubr() +
  scale_y_continuous(limits = c(-0.40, 1), 
                     breaks = seq(from = -0.25, to = 1, by = 0.25), 
                     expand = c(0, 0.05)) +
  scale_x_continuous(limits = c(70, 88), 
                     breaks = seq(from = 70, to = 88, by = 2), 
                     expand = c(0.05, 0.05)) +
  labs(x = expression("% of VO"["2max"]*" at PO"["4mmol"]*" (%) "), y = NULL) +
  theme(text=element_text(family="serif", face="plain", size=lable.size),
        legend.position = "none",
        axis.line.x = element_line(size = axis.width),
        axis.line.y = element_line(size = axis.width),
        axis.ticks = element_line(size = axis.ticks.width),
        axis.ticks.length = unit(0.05, "cm"))
figure5B


# Influence of C) isokinetic peak torque at 60 degrees·sec-1 at baseline on changes in maximal average power output during the 15-min cycling trial (PO15-min) in the moderate-intensity interval training (MIT) block compared to the high-intensity interval training (HIT) block.
figure5C <- data %>% 
  filter(period != "con", variable == "w.rel.15tt") %>%
  ggplot(aes(x=peak.torque.60, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = point.size) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = line.width) + # se = confidence intervals
  scale_color_manual(values = col_scale) +
  theme_pubr() +
  scale_y_continuous(limits = c(-0.40, 1), 
                     breaks = seq(from = -0.25, to = 1, by = 0.25), 
                     expand = c(0, 0.05)) +
  scale_x_continuous(limits = c(110, 260), 
                     breaks = seq(from = 120, to = 260, by = 20), 
                     expand = c(0.05, 0.05)) +
  labs(x = expression("Isometric peak torque at 60 ° ∙ sec"^-1*" (Nm) "),
       y = expression("∆ PO"["15min"]*"  (W ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=lable.size),
        legend.position = "none",
        axis.line.x = element_line(size = axis.width),
        axis.line.y = element_line(size = axis.width),
        axis.ticks = element_line(size = axis.ticks.width),
        axis.ticks.length = unit(0.05, "cm"))
figure5C


# Influence of D) thickness of m. vastus lateralis at baseline on changes in maximal average power output during the 15-min cycling trial (PO15-min) in the moderate-intensity interval training (MIT) block compared to the high-intensity interval training (HIT) block.
figure5D <- data %>% 
  filter(period != "con", variable == "w.rel.15tt") %>%
  ggplot(aes(x=lat.avg, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = point.size) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = line.width) + # se = confidence intervals
  scale_color_manual(values = col_scale) +
  theme_pubr() +
  scale_y_continuous(limits = c(-0.40, 1), 
                     breaks = seq(from = -0.25, to = 1, by = 0.25), 
                     expand = c(0, 0.05)) +
  scale_x_continuous(limits = c(28, 55), 
                     breaks = seq(from = 30, to = 55, by = 5), 
                     expand = c(0.05, 0.05)) +
  labs(x = expression(paste("Muscle thickness ", italic("m. vastus lateralis"), " (mm)")), y = NULL) +
  theme(text=element_text(family="serif", face="plain", size=lable.size),
        legend.position = "none",
        axis.line.x = element_line(size = axis.width),
        axis.line.y = element_line(size = axis.width),
        axis.ticks = element_line(size = axis.ticks.width),
        axis.ticks.length = unit(0.05, "cm"))
figure5D



figure5 <-  plot_grid(figure5A, figure5B, figure5C, figure5D,
                  align = "hv",
                  ncol = 2, rel_heights = c(1, 1, 1, 1)) +
  draw_plot_label(x = c(0, 0.5, 0, 0.5), 
                  y = c(0.98, 0.98, 0.48, 0.48), 
                  vjust = 1,
                  label = c("A", "B", "C", "D"), 
                  size = 10,
                  family="serif") +
  draw_plot_label(x = c(0.25, 0.75, 0.25, 0.75), 
                  y = c(0.92, 0.92, 0.42, 0.42), 
                  vjust = 1,
                  label = c("MIT x HIT p = 0.024", "MIT x HIT p = 0.048", 
                            "MIT x HIT p = 0.050", "MIT x HIT p = 0.043"), 
                  size = 6,
                  family="serif",
                  fontface="italic") 


figure5

# Width of figure = 2x columns 17 cm
# height of figure = 3/4 page = 23 * 0.75 cm

saveRDS(figure5, "./figures/rds/figure5.RDS")

ggsave("figures/figure5.tiff", plot = figure5, width = 16, height = 15, 
       dpi = 800,
       units = "cm", device= "tiff")



```


```{r}

# Setting axis width, axis ticks width and length, label size, line width, point size and colours
axis.width <- 0.4
axis.ticks.width <- 0.4
lable.size <- 10
line.width <- 0.6
point.size <- 0.8
col_scale <- c("#8B0000", "#104E8B")


# Figure 6

# Influence of % of maximal oxygen consumption (V̇O2max) during sessions on changes in V̇O2max in the moderate-intensity interval training (MIT) block compared to the high-intensity interval training (HIT) block.

figure6 <- data %>% 
  filter(period != "con", variable == "vo2.rel.max") %>%
  ggplot(aes(x=rel.vo2, y=change, color=period)) +
  geom_point(aes(shape=period, color=period), size = point.size) +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = line.width) + # se = confidence intervals
  scale_color_manual(values = col_scale) +
  theme_pubr() +
  scale_y_continuous(limits = c(-4, 10), 
                     breaks = seq(from = -4, to = 10, by = 2), 
                     expand = c(0.05, 0.05)) +
  scale_x_continuous(limits = c(68, 90), 
                     breaks = seq(from = 68, to = 90, by = 2), 
                     expand = c(0.05, 0.05)) +
  labs(x = expression("% of VO"["2max"]*"  during interval sessions (%) "), y = expression("∆ VO"["2max"]*"  (mL ∙ min"^-1*" ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=lable.size),
        legend.position = "none",
        axis.line.x = element_line(size = axis.width),
        axis.line.y = element_line(size = axis.width),
        axis.ticks = element_line(size = axis.ticks.width),
        axis.ticks.length = unit(0.05, "cm"))
figure6


# Width of figure = 2x columns 17 cm
# height of figure = 3/4 page = 23 * 0.75 cm

saveRDS(figure6, "./figures/rds/figure6.RDS")

ggsave("figures/figure6.tiff", plot = figure6, width = 8.5, height = 7, 
       dpi = 800,
       units = "cm", device= "tiff")


```
