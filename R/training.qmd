---
title: "training"
format: html
editor: visual
editor_options: 
  chunk_output_type: console
---

# Training diary

```{r}

# In this code chunk training diary data for the participants performing the
# MIT and HIT block, as well as the participants performing the control period
# (CON) are calculated


# Saving the training diary data
training_diary <-read_excel("data/training_diary_ir_data.xlsx", na = "na") %>% 
  print()

# Period and group to factor
training_diary$period <- as.factor(training_diary$period)


# Making a table with mean (SD) for the given training varibles for the whole intervention
training <-
  training_diary %>% 
  mutate(trimp.1 = (zone.1 + zone.2)* 1) %>%
  mutate(trimp.2 = (zone.3 + zone.4)* 2) %>%
  mutate(trimp.3 = (zone.5)* 3) %>%
  mutate(total.trimp = trimp.1 + trimp.2 + trimp.3) %>% 
  mutate(strength.heavy = strength.heavy) %>%
  mutate(strength.general = strength.general) %>%
  mutate(total.t.training = total.t.training) %>%
  filter(!period  %in% c("pre.mit", "pre.hit", "pre.con")) %>%
  group_by(period) %>%
  print()



training_table <- training %>%
  group_by(period) %>%
  summarise(across(c(zone.1:zone.5, trimp.1:trimp.3, total.trimp, strength.heavy, strength.general, total.t.training, feeling.legs), 
                   list(m = mean, s = sd), na.rm = TRUE)) %>% 
  mutate("Zone 1 (min)" = paste0(round(zone.1_m, 1), " (", round(zone.1_s, 1),")"),
               "Zone 2 (min)" = paste0(round(zone.2_m, 1), " (", round(zone.2_s, 1),")"),
               "Zone 3 (min)" = paste0(round(zone.3_m, 1), " (", round(zone.3_s, 1),")"),
               "Zone 4 (min)" = paste0(round(zone.4_m, 1), " (", round(zone.4_s, 1),")"),
               "Zone 5 (min)" = paste0(round(zone.5_m, 1), " (", round(zone.5_s, 1),")"),
               "Trimp 1" = paste0(round(trimp.1_m, 0), " (", round(trimp.1_s, 0),")"),
               "Trimp 2" = paste0(round(trimp.2_m, 0), " (", round(trimp.2_s, 0),")"),
               "Trimp 3" = paste0(round(trimp.3_m, 0), " (", round(trimp.3_s, 0),")"),
               "Total trimp" = paste0(round(total.trimp_m, 0), " (", round(total.trimp_s, 0),")"),
               "Maximal strength (min)" = paste0(round(strength.heavy_m, 1), 
                                                 " (", round(strength.heavy_s, 1),")"),
               "General strength (min)" = paste0(round(strength.general_m, 1), 
                                                 " (", round(strength.general_s, 1),")"),
               "Total training (min)" = paste0(round(total.t.training_m, 1), 
                                               " (", round(total.t.training_s, 1),")"),
               "Feeling legs (1-9)" = paste0(round(feeling.legs_m, 1), 
                                             " (", round(feeling.legs_s, 1),")") ) %>%
  select(period, "Zone 1 (min)", "Zone 2 (min)", "Zone 3 (min)", "Zone 4 (min)", "Zone 5 (min)", "Trimp 1", "Trimp 2", "Trimp 3", "Total trimp", "Maximal strength (min)", "General strength (min)", "Total training (min)", "Feeling legs (1-9)") %>%
  pivot_longer(names_to = "variable", values_to = "stat", "Zone 1 (min)":"Feeling legs (1-9)") %>% 
  pivot_wider(names_from = period, values_from = stat) %>%
  print()


write_xlsx(training_table, "C:\\ir-mit-hit\\training_ir.xlsx")

mod <- lmer(total.t.training ~ period + (1|id), data = training) %>% print()
summary(mod)
pairs(emmeans(mod, specs = ~ period))

mod <- lmer(total.trimp ~ period + (1|id), data = training) %>% print()
summary(mod)
pairs(emmeans(mod, specs = ~ period))

mod <- lmer(trimp.1 ~ period + (1|id), data = training) %>% print()
summary(mod)
pairs(emmeans(mod, specs = ~ period))

mod <- lmer(trimp.2 ~ period + (1|id), data = training) %>% print()
summary(mod)
pairs(emmeans(mod, specs = ~ period))

mod <- lmer(trimp.3 ~ period + (1|id), data = training) %>% print()
summary(mod)
pairs(emmeans(mod, specs = ~ period))

mod <- lmer(feeling.legs ~ period + (1|id), data = training) %>% print()
summary(mod)
pairs(emmeans(mod, specs = ~ period))


```