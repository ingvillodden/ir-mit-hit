---
title: "relationship ir mit hit"
format: html
editor: visual
editor_options: 
  chunk_output_type: console
---

#### Relationship between individual observed responses to MIT and HIT 

```{r}

# In this code chunk simple linear models are used to investigate potential correlations between the observed individual responses in MIT and HIT. Also, ICC scores are computed to investigate the reliability of the changes in outcome variables between blocks


## Endurance performance index

# Formatting data to fit analyses
relation_data <- data %>%
  filter(period != "con") %>% 
  filter(variable == "index") %>% 
  select(id, period, change) %>% 
  pivot_wider(names_from = period,
              values_from = change) %>% 
  subset(select = -id) %>%
  print()

# Correlation
pearsons.r <- cor.test(relation_data$mit, relation_data$hit, method = "pearson") %>% print()


# ICC score
icc <- ICC(relation_data, alpha=.05, missing = TRUE) %>%  print()



## PO15min

relation_data <- data %>%
  filter(period != "con") %>% 
  filter(variable == "w.rel.15tt") %>% 
  select(id, period, change) %>% 
  pivot_wider(names_from = period,
              values_from = change) %>% 
  subset(select = -id) %>%
  print()

pearsons.r <- cor.test(relation_data$mit, relation_data$hit, method = "pearson") %>% print()

icc <- ICC(relation_data, alpha=.05, missing = TRUE) %>%  print()



## POVO2max

relation_data <- data %>%
  filter(period != "con") %>% 
  filter(variable == "w.rel.max") %>% 
  select(id, period, change) %>% 
  pivot_wider(names_from = period,
              values_from = change) %>% 
  subset(select = -id) %>%
  print()

pearsons.r <- cor.test(relation_data$mit, relation_data$hit, method = "pearson") %>% print()



## PO4mmol

relation_data <- data %>%
  filter(period != "con") %>% 
  filter(variable == "w.rel.4mmol") %>% 
  select(id, period, change) %>% 
  pivot_wider(names_from = period,
              values_from = change) %>% 
  subset(select = -id) %>%
  print()

pearsons.r <- cor.test(relation_data$mit, relation_data$hit, method = "pearson") %>% print()


icc <- ICC(relation_data, alpha=.05, missing = TRUE) %>%  print()



## VO2max

relation_data <- data %>%
  filter(period != "con") %>% 
  filter(variable == "vo2.rel.max") %>% 
  select(id, period, change) %>% 
  pivot_wider(names_from = period,
              values_from = change) %>% 
  subset(select = -id) %>%
  print()

pearsons.r <- cor.test(relation_data$mit, relation_data$hit, method = "pearson") %>% print()

icc <- ICC(relation_data, alpha=.05, missing = TRUE) %>%  print()



## % of VO2max at 4mmol [LA-]

relation_data <- data %>%
  filter(period != "con") %>% 
  filter(variable == "p.vo2.4mmol") %>% 
  select(id, period, change) %>% 
  pivot_wider(names_from = period,
              values_from = change) %>% 
  subset(select = -id) %>%
  print()

pearsons.r <- cor.test(relation_data$mit, relation_data$hit, method = "pearson") %>% print()
mod <- lm(mit ~ hit, data = relation_data) 
summ(mod, confint = TRUE, digits = 3)

icc <- ICC(relation_data, alpha=.05, missing = TRUE) %>%  print()

fig <- ggplot(relation_data, aes(x=hit, y=mit)) +
  geom_point() +
  geom_smooth(method="lm", colour = "black") +
  theme_pubr() +
  labs(x = expression("HIT   ∆ % of VO"["2max"]*"  ( %-points) "), 
       y = expression("MIT   ∆ % of VO"["2max"]*"  ( %-points) ")) +
  theme(text=element_text(family="serif", face="plain", size=11))
fig


## GE (at the 3.last bout of the blood lactate profile in the fresh state)

relation_data <- data %>%
  filter(period != "con") %>% 
  filter(variable == "ge.3.fresh") %>% 
  select(id, period, change) %>% 
  pivot_wider(names_from = period,
              values_from = change) %>% 
  subset(select = -id) %>%
  print()

pearsons.r <- cor.test(relation_data$mit, relation_data$hit, method = "pearson") %>% print()

icc <- ICC(relation_data, alpha=.05, missing = TRUE) %>%  print()


```


```{r}

# Figure 4

axis.width <- 0.4
axis.ticks.width <- 0.4
lable.size <- 10
line.width <- 0.6
point.size <- 0.8


## PO15min

relation_data <- data %>%
  filter(period != "con") %>% 
  filter(variable == "w.rel.15tt") %>% 
  select(id, period, change) %>% 
  pivot_wider(names_from = period,
              values_from = change) %>% 
  subset(select = -id) %>%
  print()


figure4 <- ggplot(relation_data, aes(x=mit, y=hit)) +
  geom_point(size = point.size, colour = "black") +
  geom_smooth(method="lm", se=TRUE, level = 0.95, lwd = line.width, colour = "black") +
  theme_pubr() +
  scale_y_continuous(limits = c(-0.4, 0.5), 
                     breaks = seq(from = -0.25, to = 0.5, by = 0.25), 
                     expand = c(0, 0.05)) +
  scale_x_continuous(limits = c(-0.35, 1), 
                     breaks = seq(from = -0.25, to = 1, by = 0.25), 
                     expand = c(0.05, 0.05)) +
  labs(x = expression("MIT   ∆ PO"["15-min"]*"  (W ∙ kg"^-1*") "), 
       y = expression("HIT   ∆ PO"["15-min"]*"  (W ∙ kg"^-1*") ")) +
  theme(text=element_text(family="serif", face="plain", size=lable.size),
        legend.position = "none",
        axis.line.x = element_line(linewidth = axis.width),
        axis.line.y = element_line(linewidth = axis.width),
        axis.ticks = element_line(linewidth = axis.ticks.width),
        axis.ticks.length = unit(0.05, "cm"))
figure4


# Figure size
# Width =  1 column = 8.5 cm
# height of figure = 9 cm

saveRDS(figure4, "./figures/rds/figure4.RDS")

ggsave("figures/figure4.tiff", plot = figure4, width = 8.5, height = 7, 
       dpi = 800,
       units = "cm", device= "tiff")




```


